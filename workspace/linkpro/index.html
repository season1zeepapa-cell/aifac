<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LinkPro - 나만의 링크 페이지</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
          },
        },
      },
    };
  </script>
  <style>
    /* 커스텀 스타일 - Tailwind으로 불가능한 것만 */
    * { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes toastIn { from { opacity: 0; transform: translateX(100%); } to { opacity: 1; transform: translateX(0); } }
    @keyframes toastOut { from { opacity: 1; transform: translateX(0); } to { opacity: 0; transform: translateX(100%); } }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
    .animate-slideUp { animation: slideUp 0.4s ease-out; }
    .animate-toastIn { animation: toastIn 0.3s ease-out; }
    .animate-toastOut { animation: toastOut 0.3s ease-in forwards; }
    .animate-spin { animation: spin 1s linear infinite; }
    .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    /* 스크롤바 최소화 */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    // ========================================
    // React Hooks 구조 분해
    // ========================================
    const {
      useState, useEffect, useContext, useCallback, useMemo, useRef,
      createContext, Fragment
    } = React;

    // ========================================
    // 상수 및 설정
    // ========================================
    const API_BASE_URL = '/api';
    const TOKEN_KEY = 'linkpro_token';
    const USER_KEY = 'linkpro_user';

    // ========================================
    // 프리셋 테마 정의
    // ========================================
    const THEMES = {
      default: {
        name: '기본',
        background: 'bg-white',
        backgroundStyle: { background: '#ffffff' },
        textColor: 'text-gray-900',
        subTextColor: 'text-gray-600',
        buttonClass: 'bg-white border-2 border-gray-900 text-gray-900 hover:bg-gray-900 hover:text-white',
        previewBg: '#ffffff',
        previewBtn: '#1f2937',
        previewBtnText: '#ffffff',
      },
      ocean: {
        name: '오션',
        background: '',
        backgroundStyle: { background: 'linear-gradient(135deg, #0061ff 0%, #60efff 100%)' },
        textColor: 'text-white',
        subTextColor: 'text-white/80',
        buttonClass: 'bg-white/20 backdrop-blur-sm border border-white/30 text-white hover:bg-white/30',
        previewBg: 'linear-gradient(135deg, #0061ff, #60efff)',
        previewBtn: 'rgba(255,255,255,0.25)',
        previewBtnText: '#ffffff',
      },
      sunset: {
        name: '선셋',
        background: '',
        backgroundStyle: { background: 'linear-gradient(135deg, #ff6b35 0%, #f7c59f 100%)' },
        textColor: 'text-white',
        subTextColor: 'text-white/80',
        buttonClass: 'bg-white/20 backdrop-blur-sm border border-white/30 text-white hover:bg-white/30',
        previewBg: 'linear-gradient(135deg, #ff6b35, #f7c59f)',
        previewBtn: 'rgba(255,255,255,0.25)',
        previewBtnText: '#ffffff',
      },
      forest: {
        name: '포레스트',
        background: '',
        backgroundStyle: { background: 'linear-gradient(135deg, #134e5e 0%, #71b280 100%)' },
        textColor: 'text-white',
        subTextColor: 'text-white/80',
        buttonClass: 'bg-white/20 backdrop-blur-sm border border-white/30 text-white hover:bg-white/30',
        previewBg: 'linear-gradient(135deg, #134e5e, #71b280)',
        previewBtn: 'rgba(255,255,255,0.25)',
        previewBtnText: '#ffffff',
      },
      midnight: {
        name: '미드나잇',
        background: '',
        backgroundStyle: { background: 'linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%)' },
        textColor: 'text-white',
        subTextColor: 'text-white/70',
        buttonClass: 'bg-purple-500/30 backdrop-blur-sm border border-purple-400/30 text-white hover:bg-purple-500/50',
        previewBg: 'linear-gradient(135deg, #0f0c29, #302b63, #24243e)',
        previewBtn: 'rgba(139,92,246,0.35)',
        previewBtnText: '#ffffff',
      },
      candy: {
        name: '캔디',
        background: '',
        backgroundStyle: { background: 'linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)' },
        textColor: 'text-purple-900',
        subTextColor: 'text-purple-800/70',
        buttonClass: 'bg-white/50 backdrop-blur-sm border border-white/60 text-purple-900 hover:bg-white/70',
        previewBg: 'linear-gradient(135deg, #ff9a9e, #fecfef)',
        previewBtn: 'rgba(255,255,255,0.55)',
        previewBtnText: '#581c87',
      },
    };

    // ========================================
    // 유틸리티 함수
    // ========================================
    function getToken() {
      return localStorage.getItem(TOKEN_KEY);
    }

    function getUser() {
      try {
        const raw = localStorage.getItem(USER_KEY);
        return raw ? JSON.parse(raw) : null;
      } catch { return null; }
    }

    function saveAuth(token, user) {
      localStorage.setItem(TOKEN_KEY, token);
      localStorage.setItem(USER_KEY, JSON.stringify(user));
    }

    function clearAuth() {
      localStorage.removeItem(TOKEN_KEY);
      localStorage.removeItem(USER_KEY);
    }

    // API 호출 래퍼
    async function apiCall(endpoint, options = {}) {
      const token = getToken();
      const headers = { 'Content-Type': 'application/json', ...options.headers };
      if (token) headers['Authorization'] = `Bearer ${token}`;

      const res = await fetch(`${API_BASE_URL}${endpoint}`, { ...options, headers });
      const data = await res.json();

      if (!res.ok) {
        throw new Error(data.message || `요청 실패 (${res.status})`);
      }
      return data;
    }

    // ========================================
    // 토스트 컨텍스트
    // ========================================
    const ToastContext = createContext(null);

    function ToastProvider({ children }) {
      const [toasts, setToasts] = useState([]);
      const idRef = useRef(0);

      const addToast = useCallback((message, type = 'info') => {
        const id = ++idRef.current;
        setToasts(prev => [...prev, { id, message, type, removing: false }]);
        setTimeout(() => {
          setToasts(prev => prev.map(t => t.id === id ? { ...t, removing: true } : t));
          setTimeout(() => {
            setToasts(prev => prev.filter(t => t.id !== id));
          }, 300);
        }, 3000);
      }, []);

      const toast = useMemo(() => ({
        info: (msg) => addToast(msg, 'info'),
        success: (msg) => addToast(msg, 'success'),
        error: (msg) => addToast(msg, 'error'),
      }), [addToast]);

      return (
        <ToastContext.Provider value={toast}>
          {children}
          <div className="fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-sm">
            {toasts.map(t => (
              <div
                key={t.id}
                className={`px-4 py-3 rounded-lg shadow-lg text-sm font-medium ${
                  t.removing ? 'animate-toastOut' : 'animate-toastIn'
                } ${
                  t.type === 'success' ? 'bg-green-500 text-white' :
                  t.type === 'error' ? 'bg-red-500 text-white' :
                  'bg-gray-800 text-white'
                }`}
              >
                {t.message}
              </div>
            ))}
          </div>
        </ToastContext.Provider>
      );
    }

    function useToast() {
      return useContext(ToastContext);
    }

    // ========================================
    // 인증 컨텍스트
    // ========================================
    const AuthContext = createContext(null);

    function AuthProvider({ children }) {
      const [user, setUser] = useState(getUser());
      const [loading, setLoading] = useState(true);
      const toast = useToast();

      useEffect(() => {
        const token = getToken();
        if (!token) {
          setLoading(false);
          return;
        }
        apiCall('/auth/me')
          .then(res => {
            setUser(res.data);
            localStorage.setItem(USER_KEY, JSON.stringify(res.data));
          })
          .catch(() => {
            clearAuth();
            setUser(null);
          })
          .finally(() => setLoading(false));
      }, []);

      const login = useCallback(async (email, password) => {
        const res = await apiCall('/auth/login', {
          method: 'POST',
          body: JSON.stringify({ email, password }),
        });
        saveAuth(res.data.token, res.data.user);
        setUser(res.data.user);
        return res.data.user;
      }, []);

      const register = useCallback(async (email, password, username) => {
        const res = await apiCall('/auth/register', {
          method: 'POST',
          body: JSON.stringify({ email, password, username }),
        });
        saveAuth(res.data.token, res.data.user);
        setUser(res.data.user);
        return res.data.user;
      }, []);

      const logout = useCallback(() => {
        clearAuth();
        setUser(null);
        window.location.hash = '#/login';
      }, []);

      const value = useMemo(() => ({
        user, loading, login, register, logout, isAuthenticated: !!user,
      }), [user, loading, login, register, logout]);

      return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;
    }

    function useAuth() {
      return useContext(AuthContext);
    }

    // ========================================
    // 디자인 시스템 컴포넌트
    // ========================================

    // 스피너
    function Spinner({ size = 'md', className = '' }) {
      const sizeClass = size === 'sm' ? 'w-4 h-4' : size === 'lg' ? 'w-8 h-8' : 'w-6 h-6';
      return (
        <div className={`${sizeClass} border-2 border-gray-200 border-t-indigo-600 rounded-full animate-spin ${className}`} />
      );
    }

    // 버튼
    function Button({ children, variant = 'primary', size = 'md', disabled = false, loading = false, onClick, className = '', type = 'button', ...rest }) {
      const baseClass = 'inline-flex items-center justify-center font-semibold rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed';
      const variants = {
        primary: 'bg-indigo-600 text-white hover:bg-indigo-700 focus:ring-indigo-500 shadow-sm',
        secondary: 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-indigo-500',
        danger: 'bg-red-600 text-white hover:bg-red-700 focus:ring-red-500',
        ghost: 'text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:ring-gray-500',
        success: 'bg-emerald-600 text-white hover:bg-emerald-700 focus:ring-emerald-500',
      };
      const sizes = {
        sm: 'px-3 py-1.5 text-sm',
        md: 'px-4 py-2.5 text-sm',
        lg: 'px-6 py-3 text-base',
      };
      return (
        <button
          type={type}
          disabled={disabled || loading}
          onClick={onClick}
          className={`${baseClass} ${variants[variant]} ${sizes[size]} ${className}`}
          {...rest}
        >
          {loading && <Spinner size="sm" className="mr-2" />}
          {children}
        </button>
      );
    }

    // 텍스트 입력
    function Input({ label, type = 'text', value, onChange, placeholder, error, disabled, className = '', hint, ...rest }) {
      return (
        <div className={`${className}`}>
          {label && <label className="block text-sm font-medium text-gray-700 mb-1.5">{label}</label>}
          <input
            type={type}
            value={value}
            onChange={onChange}
            placeholder={placeholder}
            disabled={disabled}
            className={`w-full px-3.5 py-2.5 border rounded-lg text-sm transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 disabled:cursor-not-allowed ${
              error ? 'border-red-400 bg-red-50' : 'border-gray-300 bg-white'
            }`}
            {...rest}
          />
          {hint && !error && <p className="mt-1 text-xs text-gray-500">{hint}</p>}
          {error && <p className="mt-1 text-xs text-red-500">{error}</p>}
        </div>
      );
    }

    // 텍스트영역
    function Textarea({ label, value, onChange, placeholder, error, disabled, rows = 3, className = '', ...rest }) {
      return (
        <div className={`${className}`}>
          {label && <label className="block text-sm font-medium text-gray-700 mb-1.5">{label}</label>}
          <textarea
            value={value}
            onChange={onChange}
            placeholder={placeholder}
            disabled={disabled}
            rows={rows}
            className={`w-full px-3.5 py-2.5 border rounded-lg text-sm transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-gray-100 resize-none ${
              error ? 'border-red-400 bg-red-50' : 'border-gray-300 bg-white'
            }`}
            {...rest}
          />
          {error && <p className="mt-1 text-xs text-red-500">{error}</p>}
        </div>
      );
    }

    // 카드
    function Card({ children, className = '' }) {
      return (
        <div className={`bg-white rounded-xl shadow-sm border border-gray-100 ${className}`}>
          {children}
        </div>
      );
    }

    // 모달
    function Modal({ isOpen, onClose, title, children, size = 'md' }) {
      useEffect(() => {
        if (isOpen) {
          document.body.style.overflow = 'hidden';
        } else {
          document.body.style.overflow = '';
        }
        return () => { document.body.style.overflow = ''; };
      }, [isOpen]);

      if (!isOpen) return null;

      const sizeClass = size === 'sm' ? 'max-w-sm' : size === 'lg' ? 'max-w-lg' : 'max-w-md';

      return (
        <div className="fixed inset-0 z-40 flex items-center justify-center p-4">
          <div className="fixed inset-0 bg-black/50 backdrop-blur-sm" onClick={onClose} />
          <div className={`relative bg-white rounded-2xl shadow-xl w-full ${sizeClass} animate-slideUp`}>
            <div className="flex items-center justify-between p-5 border-b border-gray-100">
              <h3 className="text-lg font-bold text-gray-900">{title}</h3>
              <button onClick={onClose} className="p-1.5 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors">
                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
            </div>
            <div className="p-5">{children}</div>
          </div>
        </div>
      );
    }

    // 토글 스위치
    function Toggle({ checked, onChange, label }) {
      return (
        <label className="inline-flex items-center cursor-pointer gap-2">
          <div
            className={`relative w-10 h-5.5 rounded-full transition-colors duration-200 ${checked ? 'bg-indigo-600' : 'bg-gray-300'}`}
            onClick={() => onChange(!checked)}
            style={{ width: '40px', height: '22px' }}
          >
            <div
              className={`absolute top-0.5 left-0.5 w-4.5 h-4.5 bg-white rounded-full shadow transition-transform duration-200 ${checked ? 'translate-x-[18px]' : ''}`}
              style={{ width: '18px', height: '18px' }}
            />
          </div>
          {label && <span className="text-sm text-gray-700">{label}</span>}
        </label>
      );
    }

    // 빈 상태
    function EmptyState({ icon, title, description, action }) {
      return (
        <div className="flex flex-col items-center justify-center py-12 text-center">
          {icon && <div className="text-4xl mb-3">{icon}</div>}
          <h3 className="text-lg font-semibold text-gray-700 mb-1">{title}</h3>
          {description && <p className="text-sm text-gray-500 mb-4">{description}</p>}
          {action}
        </div>
      );
    }

    // 전체 페이지 로딩
    function FullPageLoading() {
      return (
        <div className="flex items-center justify-center min-h-screen bg-gray-50">
          <div className="flex flex-col items-center gap-3">
            <Spinner size="lg" />
            <p className="text-sm text-gray-500">로딩 중...</p>
          </div>
        </div>
      );
    }

    // ========================================
    // 해시 라우터
    // ========================================
    const RouterContext = createContext({ path: '/', navigate: () => {} });

    function useRouter() {
      return useContext(RouterContext);
    }

    function HashRouter({ children }) {
      const [path, setPath] = useState(() => {
        const hash = window.location.hash.slice(1);
        return hash || '/';
      });

      useEffect(() => {
        function handleHashChange() {
          const hash = window.location.hash.slice(1);
          setPath(hash || '/');
        }
        window.addEventListener('hashchange', handleHashChange);
        return () => window.removeEventListener('hashchange', handleHashChange);
      }, []);

      const navigate = useCallback((to) => {
        window.location.hash = `#${to}`;
      }, []);

      return (
        <RouterContext.Provider value={{ path, navigate }}>
          {children}
        </RouterContext.Provider>
      );
    }

    function matchRoute(pattern, path) {
      const patternParts = pattern.split('/');
      const pathParts = path.split('/');
      if (patternParts.length !== pathParts.length) return null;
      const params = {};
      for (let i = 0; i < patternParts.length; i++) {
        if (patternParts[i].startsWith(':')) {
          params[patternParts[i].slice(1)] = pathParts[i];
        } else if (patternParts[i] !== pathParts[i]) {
          return null;
        }
      }
      return params;
    }

    function Routes({ children }) {
      const { path } = useRouter();
      const routes = React.Children.toArray(children);
      for (const route of routes) {
        const params = matchRoute(route.props.path, path);
        if (params !== null) {
          return React.cloneElement(route.props.element, { params });
        }
      }
      return <NotFoundPage />;
    }

    function Route({ path, element }) {
      return null; // Routes에서 처리
    }

    function Link({ to, children, className = '', ...rest }) {
      return (
        <a
          href={`#${to}`}
          className={className}
          onClick={(e) => {
            e.preventDefault();
            window.location.hash = `#${to}`;
          }}
          {...rest}
        >
          {children}
        </a>
      );
    }

    // ========================================
    // 아이콘 컴포넌트들 (인라인 SVG)
    // ========================================
    function IconLink() {
      return (
        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
        </svg>
      );
    }

    function IconEdit() {
      return (
        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
        </svg>
      );
    }

    function IconTrash() {
      return (
        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
        </svg>
      );
    }

    function IconChevronUp() {
      return (
        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 15l7-7 7 7" />
        </svg>
      );
    }

    function IconChevronDown() {
      return (
        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
        </svg>
      );
    }

    function IconCopy() {
      return (
        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
        </svg>
      );
    }

    function IconExternalLink() {
      return (
        <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
        </svg>
      );
    }

    function IconPlus() {
      return (
        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
        </svg>
      );
    }

    function IconLogout() {
      return (
        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
        </svg>
      );
    }

    // ========================================
    // 랜딩 페이지
    // ========================================
    function LandingPage() {
      return (
        <div className="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 flex flex-col">
          {/* 헤더 */}
          <header className="w-full px-6 py-4 flex items-center justify-between max-w-5xl mx-auto">
            <div className="flex items-center gap-2">
              <div className="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center">
                <span className="text-white font-bold text-sm">L</span>
              </div>
              <span className="text-xl font-bold text-gray-900">LinkPro</span>
            </div>
            <Link to="/login" className="text-sm font-medium text-gray-600 hover:text-indigo-600 transition-colors">
              로그인
            </Link>
          </header>

          {/* 메인 */}
          <main className="flex-1 flex items-center justify-center px-6">
            <div className="text-center max-w-lg animate-fadeIn">
              {/* 로고 */}
              <div className="w-20 h-20 bg-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-8 shadow-lg shadow-indigo-600/30">
                <span className="text-white font-extrabold text-3xl">L</span>
              </div>

              <h1 className="text-4xl sm:text-5xl font-extrabold text-gray-900 mb-4 leading-tight">
                나만의 링크 페이지를<br />몇 초 만에 만들어 보세요
              </h1>
              <p className="text-lg text-gray-600 mb-8 leading-relaxed">
                소셜 미디어, 포트폴리오, 콘텐츠를<br className="sm:hidden" />
                하나의 링크로 공유하세요.
              </p>

              <div className="flex flex-col sm:flex-row gap-3 justify-center">
                <Link to="/register">
                  <Button size="lg" className="w-full sm:w-auto">
                    무료로 시작하기
                  </Button>
                </Link>
                <Link to="/login">
                  <Button variant="secondary" size="lg" className="w-full sm:w-auto">
                    로그인
                  </Button>
                </Link>
              </div>

              {/* 미리보기 카드 */}
              <div className="mt-16 relative">
                <div className="w-72 mx-auto bg-gradient-to-br from-indigo-500 to-purple-600 rounded-3xl p-6 shadow-2xl shadow-indigo-500/20">
                  <div className="w-16 h-16 bg-white/20 rounded-full mx-auto mb-3" />
                  <div className="h-4 w-24 bg-white/30 rounded mx-auto mb-2" />
                  <div className="h-3 w-32 bg-white/20 rounded mx-auto mb-6" />
                  <div className="space-y-2.5">
                    <div className="h-11 bg-white/20 rounded-xl" />
                    <div className="h-11 bg-white/20 rounded-xl" />
                    <div className="h-11 bg-white/20 rounded-xl" />
                  </div>
                </div>
              </div>
            </div>
          </main>

          {/* 푸터 */}
          <footer className="text-center py-6 text-sm text-gray-400">
            Powered by LinkPro
          </footer>
        </div>
      );
    }

    // ========================================
    // 로그인 페이지
    // ========================================
    function LoginPage() {
      const { login, isAuthenticated } = useAuth();
      const { navigate } = useRouter();
      const toast = useToast();
      const [email, setEmail] = useState('');
      const [password, setPassword] = useState('');
      const [loading, setLoading] = useState(false);
      const [errors, setErrors] = useState({});

      useEffect(() => {
        if (isAuthenticated) navigate('/dashboard');
      }, [isAuthenticated, navigate]);

      const validate = () => {
        const newErrors = {};
        if (!email.trim()) newErrors.email = '이메일을 입력해 주세요.';
        if (!password) newErrors.password = '비밀번호를 입력해 주세요.';
        setErrors(newErrors);
        return Object.keys(newErrors).length === 0;
      };

      const handleSubmit = async (e) => {
        e.preventDefault();
        if (!validate()) return;
        setLoading(true);
        try {
          await login(email, password);
          toast.success('로그인 되었습니다!');
          navigate('/dashboard');
        } catch (err) {
          toast.error(err.message);
        } finally {
          setLoading(false);
        }
      };

      return (
        <div className="min-h-screen bg-gray-50 flex flex-col items-center justify-center px-4">
          <div className="w-full max-w-sm animate-fadeIn">
            {/* 로고 */}
            <Link to="/" className="flex items-center justify-center gap-2 mb-8">
              <div className="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center">
                <span className="text-white font-bold text-sm">L</span>
              </div>
              <span className="text-xl font-bold text-gray-900">LinkPro</span>
            </Link>

            <Card className="p-6">
              <h2 className="text-xl font-bold text-gray-900 text-center mb-6">로그인</h2>
              <form onSubmit={handleSubmit} className="space-y-4">
                <Input
                  label="이메일"
                  type="email"
                  value={email}
                  onChange={e => setEmail(e.target.value)}
                  placeholder="email@example.com"
                  error={errors.email}
                />
                <Input
                  label="비밀번호"
                  type="password"
                  value={password}
                  onChange={e => setPassword(e.target.value)}
                  placeholder="비밀번호를 입력하세요"
                  error={errors.password}
                />
                <Button type="submit" loading={loading} className="w-full">
                  로그인
                </Button>
              </form>
            </Card>

            <p className="text-center text-sm text-gray-500 mt-4">
              계정이 없으신가요?{' '}
              <Link to="/register" className="text-indigo-600 font-medium hover:text-indigo-700">
                회원가입하기
              </Link>
            </p>
          </div>
        </div>
      );
    }

    // ========================================
    // 회원가입 페이지
    // ========================================
    function RegisterPage() {
      const { register, isAuthenticated } = useAuth();
      const { navigate } = useRouter();
      const toast = useToast();
      const [email, setEmail] = useState('');
      const [password, setPassword] = useState('');
      const [username, setUsername] = useState('');
      const [loading, setLoading] = useState(false);
      const [errors, setErrors] = useState({});

      useEffect(() => {
        if (isAuthenticated) navigate('/dashboard');
      }, [isAuthenticated, navigate]);

      const validate = () => {
        const newErrors = {};
        if (!email.trim()) newErrors.email = '이메일을 입력해 주세요.';
        if (!username.trim()) {
          newErrors.username = '사용자 이름을 입력해 주세요.';
        } else if (!/^[a-z0-9_-]+$/.test(username)) {
          newErrors.username = '영문 소문자, 숫자, 하이픈(-), 언더스코어(_)만 사용할 수 있습니다.';
        }
        if (!password) {
          newErrors.password = '비밀번호를 입력해 주세요.';
        } else if (password.length < 6) {
          newErrors.password = '비밀번호는 6자 이상이어야 합니다.';
        }
        setErrors(newErrors);
        return Object.keys(newErrors).length === 0;
      };

      const handleSubmit = async (e) => {
        e.preventDefault();
        if (!validate()) return;
        setLoading(true);
        try {
          await register(email, password, username);
          toast.success('가입이 완료되었습니다!');
          navigate('/dashboard');
        } catch (err) {
          toast.error(err.message);
        } finally {
          setLoading(false);
        }
      };

      return (
        <div className="min-h-screen bg-gray-50 flex flex-col items-center justify-center px-4">
          <div className="w-full max-w-sm animate-fadeIn">
            {/* 로고 */}
            <Link to="/" className="flex items-center justify-center gap-2 mb-8">
              <div className="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center">
                <span className="text-white font-bold text-sm">L</span>
              </div>
              <span className="text-xl font-bold text-gray-900">LinkPro</span>
            </Link>

            <Card className="p-6">
              <h2 className="text-xl font-bold text-gray-900 text-center mb-6">회원가입</h2>
              <form onSubmit={handleSubmit} className="space-y-4">
                <Input
                  label="이메일"
                  type="email"
                  value={email}
                  onChange={e => setEmail(e.target.value)}
                  placeholder="email@example.com"
                  error={errors.email}
                />
                <Input
                  label="사용자 이름 (URL에 사용)"
                  value={username}
                  onChange={e => setUsername(e.target.value.toLowerCase())}
                  placeholder="my-username"
                  error={errors.username}
                  hint="영문 소문자, 숫자, 하이픈(-), 언더스코어(_)만 사용 가능"
                />
                <Input
                  label="비밀번호"
                  type="password"
                  value={password}
                  onChange={e => setPassword(e.target.value)}
                  placeholder="6자 이상"
                  error={errors.password}
                />
                <Button type="submit" loading={loading} className="w-full">
                  가입하기
                </Button>
              </form>
            </Card>

            <p className="text-center text-sm text-gray-500 mt-4">
              이미 계정이 있으신가요?{' '}
              <Link to="/login" className="text-indigo-600 font-medium hover:text-indigo-700">
                로그인하기
              </Link>
            </p>
          </div>
        </div>
      );
    }

    // ========================================
    // 대시보드 - 프로필 섹션
    // ========================================
    function ProfileSection() {
      const toast = useToast();
      const [profile, setProfile] = useState(null);
      const [loading, setLoading] = useState(true);
      const [saving, setSaving] = useState(false);
      const [displayName, setDisplayName] = useState('');
      const [bio, setBio] = useState('');
      const [avatarUrl, setAvatarUrl] = useState('');
      const [theme, setTheme] = useState('default');

      useEffect(() => {
        loadProfile();
      }, []);

      const loadProfile = async () => {
        try {
          const res = await apiCall('/profile');
          const p = res.data;
          setProfile(p);
          setDisplayName(p.display_name || '');
          setBio(p.bio || '');
          setAvatarUrl(p.avatar_url || '');
          setTheme(p.theme || 'default');
        } catch (err) {
          toast.error('프로필 로딩 실패: ' + err.message);
        } finally {
          setLoading(false);
        }
      };

      const handleSave = async () => {
        setSaving(true);
        try {
          const res = await apiCall('/profile', {
            method: 'PUT',
            body: JSON.stringify({
              display_name: displayName,
              bio: bio,
              avatar_url: avatarUrl,
              theme: theme,
            }),
          });
          setProfile(res.data);
          toast.success('프로필이 저장되었습니다!');
        } catch (err) {
          toast.error(err.message);
        } finally {
          setSaving(false);
        }
      };

      if (loading) {
        return (
          <Card className="p-6">
            <div className="flex items-center justify-center py-8">
              <Spinner />
            </div>
          </Card>
        );
      }

      return (
        <Card className="p-6">
          <h3 className="text-lg font-bold text-gray-900 mb-5">프로필 설정</h3>

          <div className="space-y-5">
            {/* 아바타 미리보기 */}
            <div className="flex items-center gap-4">
              <div className="w-20 h-20 rounded-full bg-gray-100 border-2 border-gray-200 overflow-hidden flex-shrink-0 flex items-center justify-center">
                {avatarUrl ? (
                  <img
                    src={avatarUrl}
                    alt="아바타"
                    className="w-full h-full object-cover"
                    onError={e => { e.target.style.display = 'none'; e.target.nextSibling.style.display = 'flex'; }}
                  />
                ) : null}
                <div
                  className={`w-full h-full items-center justify-center text-gray-400 ${avatarUrl ? 'hidden' : 'flex'}`}
                >
                  <svg className="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                  </svg>
                </div>
              </div>
              <div className="flex-1">
                <Input
                  label="아바타 URL"
                  value={avatarUrl}
                  onChange={e => setAvatarUrl(e.target.value)}
                  placeholder="https://example.com/avatar.jpg"
                />
              </div>
            </div>

            <Input
              label="닉네임"
              value={displayName}
              onChange={e => setDisplayName(e.target.value)}
              placeholder="표시될 이름"
            />

            <Textarea
              label="자기소개"
              value={bio}
              onChange={e => setBio(e.target.value)}
              placeholder="간단한 자기소개를 작성해 주세요."
              rows={3}
            />

            {/* 테마 선택 */}
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-3">테마 선택</label>
              <div className="grid grid-cols-3 gap-3">
                {Object.entries(THEMES).map(([key, t]) => (
                  <button
                    key={key}
                    onClick={() => setTheme(key)}
                    className={`relative rounded-xl overflow-hidden border-2 transition-all duration-200 ${
                      theme === key ? 'border-indigo-500 ring-2 ring-indigo-500/30 scale-105' : 'border-gray-200 hover:border-gray-300'
                    }`}
                  >
                    <div
                      className="h-24 p-3 flex flex-col items-center justify-center"
                      style={{ background: t.previewBg }}
                    >
                      <div
                        className="w-6 h-6 rounded-full mb-1.5"
                        style={{ background: t.previewBtn }}
                      />
                      <div
                        className="w-full h-3 rounded-md mb-1"
                        style={{ background: t.previewBtn }}
                      />
                      <div
                        className="w-full h-3 rounded-md"
                        style={{ background: t.previewBtn }}
                      />
                    </div>
                    <div className="py-1.5 bg-white text-center">
                      <span className="text-xs font-medium text-gray-700">{t.name}</span>
                    </div>
                    {theme === key && (
                      <div className="absolute top-1.5 right-1.5 w-5 h-5 bg-indigo-500 rounded-full flex items-center justify-center">
                        <svg className="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20">
                          <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
                        </svg>
                      </div>
                    )}
                  </button>
                ))}
              </div>
            </div>

            <Button onClick={handleSave} loading={saving} className="w-full">
              프로필 저장
            </Button>
          </div>
        </Card>
      );
    }

    // ========================================
    // 대시보드 - 링크 관리 섹션
    // ========================================
    function LinksSection() {
      const toast = useToast();
      const [links, setLinks] = useState([]);
      const [loading, setLoading] = useState(true);
      const [newTitle, setNewTitle] = useState('');
      const [newUrl, setNewUrl] = useState('');
      const [adding, setAdding] = useState(false);
      const [editingLink, setEditingLink] = useState(null);
      const [editTitle, setEditTitle] = useState('');
      const [editUrl, setEditUrl] = useState('');
      const [savingEdit, setSavingEdit] = useState(false);

      useEffect(() => {
        loadLinks();
      }, []);

      const loadLinks = async () => {
        try {
          const res = await apiCall('/links');
          setLinks(res.data);
        } catch (err) {
          toast.error('링크 로딩 실패: ' + err.message);
        } finally {
          setLoading(false);
        }
      };

      const handleAdd = async (e) => {
        e.preventDefault();
        if (!newTitle.trim() || !newUrl.trim()) {
          toast.error('제목과 URL을 모두 입력해 주세요.');
          return;
        }
        // URL에 프로토콜이 없으면 추가
        let url = newUrl.trim();
        if (!/^https?:\/\//i.test(url)) {
          url = 'https://' + url;
        }
        setAdding(true);
        try {
          const res = await apiCall('/links', {
            method: 'POST',
            body: JSON.stringify({ title: newTitle.trim(), url }),
          });
          setLinks(prev => [...prev, res.data]);
          setNewTitle('');
          setNewUrl('');
          toast.success('링크가 추가되었습니다!');
        } catch (err) {
          toast.error(err.message);
        } finally {
          setAdding(false);
        }
      };

      const handleDelete = async (id) => {
        if (!confirm('이 링크를 삭제하시겠습니까?')) return;
        try {
          await apiCall(`/links/${id}`, { method: 'DELETE' });
          setLinks(prev => prev.filter(l => l.id !== id));
          toast.success('링크가 삭제되었습니다.');
        } catch (err) {
          toast.error(err.message);
        }
      };

      const handleToggle = async (link) => {
        try {
          const res = await apiCall(`/links/${link.id}`, {
            method: 'PUT',
            body: JSON.stringify({ is_active: !link.is_active }),
          });
          setLinks(prev => prev.map(l => l.id === link.id ? res.data : l));
        } catch (err) {
          toast.error(err.message);
        }
      };

      const handleMoveUp = async (index) => {
        if (index === 0) return;
        const newLinks = [...links];
        [newLinks[index - 1], newLinks[index]] = [newLinks[index], newLinks[index - 1]];
        const orders = newLinks.map((l, i) => ({ id: l.id, sort_order: i }));
        setLinks(newLinks);
        try {
          await apiCall('/links/reorder', {
            method: 'PUT',
            body: JSON.stringify({ orders }),
          });
        } catch (err) {
          toast.error(err.message);
          loadLinks(); // 되돌리기
        }
      };

      const handleMoveDown = async (index) => {
        if (index === links.length - 1) return;
        const newLinks = [...links];
        [newLinks[index], newLinks[index + 1]] = [newLinks[index + 1], newLinks[index]];
        const orders = newLinks.map((l, i) => ({ id: l.id, sort_order: i }));
        setLinks(newLinks);
        try {
          await apiCall('/links/reorder', {
            method: 'PUT',
            body: JSON.stringify({ orders }),
          });
        } catch (err) {
          toast.error(err.message);
          loadLinks();
        }
      };

      const openEdit = (link) => {
        setEditingLink(link);
        setEditTitle(link.title);
        setEditUrl(link.url);
      };

      const handleSaveEdit = async () => {
        if (!editTitle.trim() || !editUrl.trim()) {
          toast.error('제목과 URL을 모두 입력해 주세요.');
          return;
        }
        let url = editUrl.trim();
        if (!/^https?:\/\//i.test(url)) {
          url = 'https://' + url;
        }
        setSavingEdit(true);
        try {
          const res = await apiCall(`/links/${editingLink.id}`, {
            method: 'PUT',
            body: JSON.stringify({ title: editTitle.trim(), url }),
          });
          setLinks(prev => prev.map(l => l.id === editingLink.id ? res.data : l));
          setEditingLink(null);
          toast.success('링크가 수정되었습니다!');
        } catch (err) {
          toast.error(err.message);
        } finally {
          setSavingEdit(false);
        }
      };

      if (loading) {
        return (
          <Card className="p-6">
            <div className="flex items-center justify-center py-8">
              <Spinner />
            </div>
          </Card>
        );
      }

      return (
        <Fragment>
          <Card className="p-6">
            <h3 className="text-lg font-bold text-gray-900 mb-5">링크 관리</h3>

            {/* 링크 추가 폼 */}
            <form onSubmit={handleAdd} className="mb-6">
              <div className="flex flex-col sm:flex-row gap-2">
                <Input
                  value={newTitle}
                  onChange={e => setNewTitle(e.target.value)}
                  placeholder="링크 제목"
                  className="flex-1"
                />
                <Input
                  value={newUrl}
                  onChange={e => setNewUrl(e.target.value)}
                  placeholder="https://example.com"
                  className="flex-1"
                />
                <Button type="submit" loading={adding} className="flex-shrink-0">
                  <IconPlus />
                  <span className="ml-1">추가</span>
                </Button>
              </div>
            </form>

            {/* 링크 목록 */}
            {links.length === 0 ? (
              <EmptyState
                icon={<IconLink />}
                title="아직 링크가 없어요"
                description="위 폼에서 첫 번째 링크를 추가해 보세요."
              />
            ) : (
              <div className="space-y-2">
                {links.map((link, index) => (
                  <div
                    key={link.id}
                    className={`flex items-center gap-3 p-3.5 rounded-xl border transition-all duration-200 ${
                      link.is_active ? 'bg-white border-gray-200' : 'bg-gray-50 border-gray-100 opacity-60'
                    }`}
                  >
                    {/* 순서 이동 버튼 */}
                    <div className="flex flex-col gap-0.5">
                      <button
                        onClick={() => handleMoveUp(index)}
                        disabled={index === 0}
                        className="p-1 rounded text-gray-400 hover:text-gray-600 hover:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed transition-colors"
                        title="위로 이동"
                      >
                        <IconChevronUp />
                      </button>
                      <button
                        onClick={() => handleMoveDown(index)}
                        disabled={index === links.length - 1}
                        className="p-1 rounded text-gray-400 hover:text-gray-600 hover:bg-gray-100 disabled:opacity-30 disabled:cursor-not-allowed transition-colors"
                        title="아래로 이동"
                      >
                        <IconChevronDown />
                      </button>
                    </div>

                    {/* 링크 정보 */}
                    <div className="flex-1 min-w-0">
                      <p className="font-medium text-sm text-gray-900 truncate">{link.title}</p>
                      <p className="text-xs text-gray-500 truncate">{link.url}</p>
                    </div>

                    {/* 액션 버튼들 */}
                    <div className="flex items-center gap-1.5 flex-shrink-0">
                      <Toggle
                        checked={link.is_active}
                        onChange={() => handleToggle(link)}
                      />
                      <button
                        onClick={() => openEdit(link)}
                        className="p-2 rounded-lg text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 transition-colors"
                        title="편집"
                      >
                        <IconEdit />
                      </button>
                      <button
                        onClick={() => handleDelete(link.id)}
                        className="p-2 rounded-lg text-gray-400 hover:text-red-600 hover:bg-red-50 transition-colors"
                        title="삭제"
                      >
                        <IconTrash />
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </Card>

          {/* 편집 모달 */}
          <Modal
            isOpen={!!editingLink}
            onClose={() => setEditingLink(null)}
            title="링크 편집"
          >
            <div className="space-y-4">
              <Input
                label="제목"
                value={editTitle}
                onChange={e => setEditTitle(e.target.value)}
                placeholder="링크 제목"
              />
              <Input
                label="URL"
                value={editUrl}
                onChange={e => setEditUrl(e.target.value)}
                placeholder="https://example.com"
              />
              <div className="flex gap-2 justify-end">
                <Button variant="secondary" onClick={() => setEditingLink(null)}>
                  취소
                </Button>
                <Button onClick={handleSaveEdit} loading={savingEdit}>
                  저장
                </Button>
              </div>
            </div>
          </Modal>
        </Fragment>
      );
    }

    // ========================================
    // 대시보드 - 공유 섹션
    // ========================================
    function ShareSection() {
      const { user } = useAuth();
      const toast = useToast();
      const [copied, setCopied] = useState(false);

      const pageUrl = `${window.location.origin}/${user?.username || ''}`;

      const handleCopy = async () => {
        try {
          await navigator.clipboard.writeText(pageUrl);
          setCopied(true);
          toast.success('URL이 복사되었습니다!');
          setTimeout(() => setCopied(false), 2000);
        } catch {
          // 폴백
          const textarea = document.createElement('textarea');
          textarea.value = pageUrl;
          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand('copy');
          document.body.removeChild(textarea);
          setCopied(true);
          toast.success('URL이 복사되었습니다!');
          setTimeout(() => setCopied(false), 2000);
        }
      };

      const shareTwitter = () => {
        window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(pageUrl)}&text=${encodeURIComponent('내 LinkPro 페이지를 확인해 보세요!')}`, '_blank');
      };

      const shareFacebook = () => {
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(pageUrl)}`, '_blank');
      };

      const shareKakao = () => {
        window.open(`https://story.kakao.com/share?url=${encodeURIComponent(pageUrl)}`, '_blank');
      };

      return (
        <Card className="p-6">
          <h3 className="text-lg font-bold text-gray-900 mb-5">페이지 공유</h3>

          {/* URL 표시 및 복사 */}
          <div className="flex items-center gap-2 mb-5">
            <div className="flex-1 bg-gray-50 border border-gray-200 rounded-lg px-3.5 py-2.5 text-sm text-gray-700 font-mono truncate">
              {pageUrl}
            </div>
            <Button
              variant={copied ? 'success' : 'secondary'}
              onClick={handleCopy}
              className="flex-shrink-0"
            >
              {copied ? (
                <Fragment>
                  <svg className="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                    <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
                  </svg>
                  복사됨!
                </Fragment>
              ) : (
                <Fragment>
                  <IconCopy />
                  <span className="ml-1">복사</span>
                </Fragment>
              )}
            </Button>
          </div>

          {/* SNS 공유 버튼들 */}
          <div className="flex gap-2">
            <button
              onClick={shareTwitter}
              className="flex-1 flex items-center justify-center gap-2 py-2.5 rounded-lg bg-[#1DA1F2] text-white text-sm font-medium hover:opacity-90 transition-opacity"
            >
              <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
              </svg>
              Twitter
            </button>
            <button
              onClick={shareFacebook}
              className="flex-1 flex items-center justify-center gap-2 py-2.5 rounded-lg bg-[#1877F2] text-white text-sm font-medium hover:opacity-90 transition-opacity"
            >
              <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
              Facebook
            </button>
            <button
              onClick={shareKakao}
              className="flex-1 flex items-center justify-center gap-2 py-2.5 rounded-lg bg-[#FEE500] text-[#3C1E1E] text-sm font-medium hover:opacity-90 transition-opacity"
            >
              <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 3c5.799 0 10.5 3.664 10.5 8.185 0 4.52-4.701 8.184-10.5 8.184a13.5 13.5 0 01-1.727-.11l-4.408 2.883c-.501.265-.678.236-.472-.413l.892-3.678c-2.88-1.46-4.785-3.99-4.785-6.866C1.5 6.664 6.201 3 12 3z"/>
              </svg>
              카카오
            </button>
          </div>
        </Card>
      );
    }

    // ========================================
    // 대시보드 페이지
    // ========================================
    function DashboardPage() {
      const { user, isAuthenticated, loading, logout } = useAuth();
      const { navigate } = useRouter();

      useEffect(() => {
        if (!loading && !isAuthenticated) {
          navigate('/login');
        }
      }, [loading, isAuthenticated, navigate]);

      if (loading) return <FullPageLoading />;
      if (!isAuthenticated) return null;

      const handleViewPage = () => {
        window.open(`/${user.username}`, '_blank');
      };

      return (
        <div className="min-h-screen bg-gray-50">
          {/* 헤더 */}
          <header className="bg-white border-b border-gray-100 sticky top-0 z-30">
            <div className="max-w-2xl mx-auto px-4 py-3 flex items-center justify-between">
              <div className="flex items-center gap-2">
                <div className="w-7 h-7 bg-indigo-600 rounded-lg flex items-center justify-center">
                  <span className="text-white font-bold text-xs">L</span>
                </div>
                <span className="text-lg font-bold text-gray-900">LinkPro</span>
              </div>
              <div className="flex items-center gap-2">
                <Button variant="secondary" size="sm" onClick={handleViewPage}>
                  <IconExternalLink />
                  <span className="ml-1.5 hidden sm:inline">내 페이지 보기</span>
                </Button>
                <Button variant="ghost" size="sm" onClick={logout} title="로그아웃">
                  <IconLogout />
                </Button>
              </div>
            </div>
          </header>

          {/* 콘텐츠 */}
          <main className="max-w-2xl mx-auto px-4 py-6 space-y-6 animate-fadeIn">
            {/* 환영 메시지 */}
            <div>
              <h2 className="text-2xl font-bold text-gray-900">
                안녕하세요, {user.username}님!
              </h2>
              <p className="text-sm text-gray-500 mt-1">프로필과 링크를 관리해 보세요.</p>
            </div>

            <ProfileSection />
            <LinksSection />
            <ShareSection />
          </main>
        </div>
      );
    }

    // ========================================
    // 공개 프로필 페이지
    // ========================================
    function PublicProfilePage({ username }) {
      const [data, setData] = useState(null);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);

      useEffect(() => {
        if (!username) return;
        setLoading(true);
        setError(null);
        fetch(`${API_BASE_URL}/public/${username}`)
          .then(res => res.json())
          .then(res => {
            if (!res.success) throw new Error(res.message);
            setData(res.data);
          })
          .catch(err => setError(err.message))
          .finally(() => setLoading(false));
      }, [username]);

      if (loading) {
        return (
          <div className="flex items-center justify-center min-h-screen" style={{ background: '#f9fafb' }}>
            <div className="flex flex-col items-center gap-3">
              <Spinner size="lg" />
              <p className="text-sm text-gray-500">페이지를 불러오는 중...</p>
            </div>
          </div>
        );
      }

      if (error || !data) {
        return (
          <div className="flex items-center justify-center min-h-screen bg-gray-50">
            <div className="text-center px-6">
              <div className="text-6xl mb-4">
                <svg className="w-16 h-16 mx-auto text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                </svg>
              </div>
              <h2 className="text-xl font-bold text-gray-700 mb-2">페이지를 찾을 수 없습니다</h2>
              <p className="text-gray-500 mb-6">{error || '해당 사용자를 찾을 수 없습니다.'}</p>
              <a
                href="/"
                className="inline-flex items-center px-4 py-2.5 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors"
              >
                홈으로 돌아가기
              </a>
            </div>
          </div>
        );
      }

      const { profile, links } = data;
      const theme = THEMES[profile.theme] || THEMES.default;

      return (
        <div
          className="min-h-screen flex flex-col"
          style={theme.backgroundStyle}
        >
          <main className="flex-1 flex flex-col items-center px-4 py-12 sm:py-16">
            <div className="w-full max-w-md animate-fadeIn">
              {/* 아바타 */}
              <div className="flex justify-center mb-4">
                <div className="w-24 h-24 rounded-full overflow-hidden border-4 border-white/30 shadow-lg flex items-center justify-center bg-white/10">
                  {profile.avatar_url ? (
                    <img
                      src={profile.avatar_url}
                      alt={profile.display_name || username}
                      className="w-full h-full object-cover"
                      onError={e => {
                        e.target.style.display = 'none';
                        if (e.target.nextSibling) e.target.nextSibling.style.display = 'flex';
                      }}
                    />
                  ) : null}
                  <div
                    className={`w-full h-full items-center justify-center ${theme.textColor} ${profile.avatar_url ? 'hidden' : 'flex'}`}
                  >
                    <svg className="w-12 h-12 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                  </div>
                </div>
              </div>

              {/* 닉네임 */}
              <h1 className={`text-xl font-bold text-center ${theme.textColor} mb-1`}>
                {profile.display_name || username}
              </h1>

              {/* 자기소개 */}
              {profile.bio && (
                <p className={`text-center text-sm ${theme.subTextColor} mb-8 leading-relaxed whitespace-pre-wrap`}>
                  {profile.bio}
                </p>
              )}
              {!profile.bio && <div className="mb-8" />}

              {/* 링크 버튼들 */}
              {links && links.length > 0 ? (
                <div className="space-y-3">
                  {links.map((link, index) => (
                    <a
                      key={link.id}
                      href={link.url}
                      target="_blank"
                      rel="noopener noreferrer"
                      className={`block w-full py-3.5 px-5 rounded-xl text-center font-medium text-sm transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] ${theme.buttonClass}`}
                      style={{ animationDelay: `${index * 0.05}s` }}
                    >
                      {link.title}
                    </a>
                  ))}
                </div>
              ) : (
                <div className={`text-center py-8 ${theme.subTextColor}`}>
                  <p className="text-sm opacity-70">아직 링크가 없습니다.</p>
                </div>
              )}
            </div>
          </main>

          {/* 푸터 */}
          <footer className="py-6 text-center">
            <a
              href="/"
              className={`inline-flex items-center gap-1.5 text-xs font-medium ${theme.subTextColor} opacity-70 hover:opacity-100 transition-opacity`}
            >
              <div className="w-4 h-4 bg-white/20 rounded flex items-center justify-center">
                <span className="text-[8px] font-bold">L</span>
              </div>
              Powered by LinkPro
            </a>
          </footer>
        </div>
      );
    }

    // ========================================
    // 404 페이지
    // ========================================
    function NotFoundPage() {
      return (
        <div className="min-h-screen bg-gray-50 flex items-center justify-center">
          <div className="text-center px-6">
            <h1 className="text-6xl font-extrabold text-gray-200 mb-4">404</h1>
            <h2 className="text-xl font-bold text-gray-700 mb-2">페이지를 찾을 수 없습니다</h2>
            <p className="text-gray-500 mb-6">요청하신 페이지가 존재하지 않습니다.</p>
            <Link to="/">
              <Button>홈으로 돌아가기</Button>
            </Link>
          </div>
        </div>
      );
    }

    // ========================================
    // SPA 해시 라우터 앱 (pathname이 "/" 일 때)
    // ========================================
    function SPAApp() {
      return (
        <HashRouter>
          <Routes>
            <Route path="/" element={<LandingPage />} />
            <Route path="/login" element={<LoginPage />} />
            <Route path="/register" element={<RegisterPage />} />
            <Route path="/dashboard" element={<DashboardPage />} />
          </Routes>
        </HashRouter>
      );
    }

    // ========================================
    // 앱 루트 컴포넌트
    // ========================================
    function App() {
      // pathname 기반으로 공개 프로필 vs SPA 분기
      const pathname = window.location.pathname;

      // "/"이면 SPA (해시 라우팅), 아니면 공개 프로필
      const isPublicProfile = pathname !== '/' && pathname !== '/index.html';

      // 공개 프로필일 때 username 추출
      const publicUsername = isPublicProfile ? pathname.replace(/^\//, '').split('/')[0] : null;

      return (
        <ToastProvider>
          <AuthProvider>
            {isPublicProfile ? (
              <PublicProfilePage username={publicUsername} />
            ) : (
              <SPAApp />
            )}
          </AuthProvider>
        </ToastProvider>
      );
    }

    // ========================================
    // 렌더링
    // ========================================
    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
